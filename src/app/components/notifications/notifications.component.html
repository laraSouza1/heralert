<!--COMPONENTE PARA VER TODAS AS NOTIFICAÇÕES DO USER LOGADO-->

<div class="container">
  <div class="line-fy"></div>

  <div>

    <!--parte esquerda fixa da app-->
    <app-left-side class="sidebar left"></app-left-side>

    <div class="content px-4 pt-4">

      <div class="div-ww">

        <!--header componente notificações-->
        <div class="flex flex-row my-2 h-tag h-2rem align-content-center align-items-center">
          <div class="flex mr-2 w-6">Notificações</div>

          <!--contagem notificações-->
          <div class="flex w-6 justify-content-end">
            <div class="number-notifications flex align-content-center align-items-center">{{ totalNotifications }}
            </div>
          </div>
        </div>

        <!--pesquisa-->
        <div class="line my-3 pt-3">
          <p-iconfield iconPosition="left" class="ml-auto">
            <p-inputicon><i class="pi pi-search"></i></p-inputicon>
            <input pInputText type="text" placeholder="Pesquisar..." class="pesquisa" (input)="onSearch($event)" />
          </p-iconfield>
        </div>

        <!--tabela para exibição de notificações-->
        <ng-container *ngIf="notifications.length > 0; else noNotifications">
          <table class="mt-4 w-full mb-6">
            <tbody>
              <tr *ngFor="let n of filteredNotifications" class="click"
                (click)="n.type === 'follow' ? goToUserProfile(n.sender_id, n.username) : goToPost(n.post_id, n.post_title)">

                <!--icon-->
                <td class="w-3rem align-items-start align-content-start">
                  <i class="pi icon-notificação flex justify-content-center"
                    [ngClass]="{ 'pi-heart': n.type === 'like', 'pi-comment': n.type === 'comment', 'pi-user-plus': n.type === 'follow'}"></i>
                </td>

                <td class="flex flex-column">

                  <!--título/tipo da notificação-->
                  <div class="title-action mb-2">
                    {{ n.type === 'like' ? 'Nova curtida' : n.type === 'comment' ? 'Novo comentário' : 'Novo seguidor'}}
                  </div>

                  <!--títupo da postagem que teve uma curtida/comentário-->
                  <div *ngIf="n.post_title" class="post-title"><i>{{ n.post_title }}</i></div>

                  <!--user de quem fez a ação-->
                  <div *ngIf="n.username" class="flex flex-row" (click)="handleMentionClick($event)">
                    <small>
                      <div [innerHTML]="('@' + n.username) | mention"></div>
                    </small>
                  </div>

                  <!--data da notificação-->
                  <div class="date mt-2">{{ n.created_at | date:'dd/MM/yyy' }}</div>
                </td>

                <!--deletar notificação-->
                <td class="w-2rem">
                  <p-toast />
                  <p-button class="delete-comment" icon="pi pi-trash"
                    (click)="handleDeleteNotification(n.id); $event.stopPropagation()" type="button">
                  </p-button>
                </td>
              </tr>
            </tbody>
          </table>
        </ng-container>

      </div>
    </div>
  </div>
</div>

<!--caso não haja notificações aparece menssagem informando-->
<ng-template #noNotifications>
  <div class="no-content flex flex-column justify-content-center align-items-center">
    <p class="flex">Ainda não há notificações!</p>
    <img src="/imgs/i.png" class="flex no-content-img" />
  </div>
</ng-template>
